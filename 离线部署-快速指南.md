# ç¦»çº¿éƒ¨ç½²å¿«é€ŸæŒ‡å—

## ğŸ¯ é€‚ç”¨åœºæ™¯

å½“æœåŠ¡å™¨**æ— æ³•é€šè¿‡ SSH è¿æ¥**æ—¶ï¼Œä½¿ç”¨æ­¤æ–¹æ³•éƒ¨ç½²ã€‚

## ğŸ“¦ æ­¥éª¤ä¸€ï¼šæ‰“åŒ…é¡¹ç›®

åœ¨æœ¬åœ°ï¼ˆWindowsï¼‰é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š

### æ–¹æ³•1ï¼šåŒå‡»è¿è¡Œï¼ˆæœ€ç®€å•ï¼‰
```
åŒå‡»è¿è¡Œï¼šæ‰“åŒ…éƒ¨ç½²æ–‡ä»¶.bat
```

### æ–¹æ³•2ï¼šPowerShell è¿è¡Œ
```powershell
.\package-for-deployment.ps1
```

### æ–¹æ³•3ï¼šæ‰‹åŠ¨æ‰“åŒ…
```powershell
# åˆ›å»ºå‹ç¼©åŒ…ï¼Œæ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶
Compress-Archive -Path src,pom.xml,deploy.sh,deploy-quick.sh,*.md `
    -DestinationPath invoice-deploy.zip
```

**æ‰“åŒ…å®Œæˆåä¼šç”Ÿæˆï¼š**
- `invoice-service-deploy-1.0.0-20231229-120000.zip`

## ğŸ“¤ æ­¥éª¤äºŒï¼šä¼ è¾“åˆ°æœåŠ¡å™¨

å°†å‹ç¼©åŒ…ä¼ è¾“åˆ°æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨ï¼š

- âœ… **Uç›˜** - æœ€å¸¸ç”¨
- âœ… **FTP/SFTP å®¢æˆ·ç«¯** - å¦‚ FileZilla
- âœ… **å†…ç½‘æ–‡ä»¶å…±äº«** - Samba/NFS
- âœ… **å…¶ä»–æ–¹å¼** - åªè¦èƒ½ä¼ åˆ°æœåŠ¡å™¨å³å¯

## ğŸ“¥ æ­¥éª¤ä¸‰ï¼šåœ¨æœåŠ¡å™¨ä¸Šè§£å‹

```bash
# 1. è§£å‹æ–‡ä»¶
unzip invoice-service-deploy-*.zip -d /tmp/

# 2. è¿›å…¥ç›®å½•
cd /tmp/invoice-service-deploy-*

# 3. æŸ¥çœ‹æ–‡ä»¶
ls -la
# åº”è¯¥çœ‹åˆ°: src/, pom.xml, deploy.sh ç­‰
```

## ğŸš€ æ­¥éª¤å››ï¼šéƒ¨ç½²åº”ç”¨

### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨éƒ¨ç½²ï¼ˆæœåŠ¡å™¨å¯ä»¥è”ç½‘ï¼‰

å¦‚æœæœåŠ¡å™¨å¯ä»¥è¿æ¥äº’è”ç½‘ä¸‹è½½ä¾èµ–ï¼š

```bash
# è¿è¡Œå®Œæ•´éƒ¨ç½²è„šæœ¬
sudo bash deploy.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… å®‰è£… Java 17
- âœ… å®‰è£… Maven
- âœ… æ„å»ºé¡¹ç›®
- âœ… é…ç½®æœåŠ¡

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²ï¼ˆå®Œå…¨ç¦»çº¿ï¼‰

å¦‚æœæœåŠ¡å™¨æ— æ³•è”ç½‘ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ä¾èµ–ï¼š

**1. å®‰è£… Java 17**

```bash
# ä¸‹è½½ Java 17 tar.gz åŒ…ï¼ˆåœ¨æœ‰ç½‘ç»œçš„æœºå™¨ä¸Šï¼‰
# ç„¶åä¼ è¾“åˆ°æœåŠ¡å™¨

# è§£å‹
sudo tar -xzf OpenJDK17U-jdk_x64_linux_hotspot_*.tar.gz -C /opt/
sudo mv /opt/jdk-17.0.* /opt/jdk-17

# è®¾ç½®ç¯å¢ƒå˜é‡
export JAVA_HOME=/opt/jdk-17
export PATH=$JAVA_HOME/bin:$PATH

# éªŒè¯
java -version
```

**2. å®‰è£… Maven**

```bash
# ä¸‹è½½ Mavenï¼ˆåœ¨æœ‰ç½‘ç»œçš„æœºå™¨ä¸Šï¼‰
# ç„¶åä¼ è¾“åˆ°æœåŠ¡å™¨

# è§£å‹
sudo tar -xzf apache-maven-3.9.5-bin.tar.gz -C /opt/

# è®¾ç½®ç¯å¢ƒå˜é‡
export MAVEN_HOME=/opt/apache-maven-3.9.5
export PATH=$MAVEN_HOME/bin:$PATH

# éªŒè¯
mvn -version
```

**3. æ„å»ºå’Œéƒ¨ç½²**

```bash
cd /tmp/invoice-service-deploy-*

# è®¾ç½®ç¯å¢ƒå˜é‡
export JAVA_HOME=/opt/jdk-17
export MAVEN_HOME=/opt/apache-maven-3.9.5
export PATH=$JAVA_HOME/bin:$MAVEN_HOME/bin:$PATH

# æ„å»ºé¡¹ç›®
mvn clean package -DskipTests

# åˆ›å»ºåº”ç”¨ç›®å½•
sudo mkdir -p /opt/invoice-service/{bin,logs,uploads,outputs,temp,config}
sudo useradd -r -s /bin/bash -d /opt/invoice-service invoice 2>/dev/null || true
sudo chown -R invoice:invoice /opt/invoice-service

# å¤åˆ¶ JAR æ–‡ä»¶
sudo cp target/invoice-service-1.0.0.jar /opt/invoice-service/bin/

# è®¾ç½® API Key
echo 'ARK_API_KEY=your_api_key_here' | sudo tee /opt/invoice-service/config/env.conf
sudo chown invoice:invoice /opt/invoice-service/config/env.conf

# å¯åŠ¨åº”ç”¨
cd /opt/invoice-service
sudo -u invoice java -jar bin/invoice-service-1.0.0.jar
```

## âœ… éªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥è¿›ç¨‹
ps aux | grep invoice-service

# æ£€æŸ¥ç«¯å£
netstat -tlnp | grep 8080

# æŸ¥çœ‹æ—¥å¿—
tail -f /opt/invoice-service/logs/invoice-service.log
```

## ğŸ“ å®Œæ•´æ–‡æ¡£

- **è¯¦ç»†ç¦»çº¿éƒ¨ç½²æŒ‡å—**: [OFFLINE-DEPLOY.md](OFFLINE-DEPLOY.md)
- **å®Œæ•´éƒ¨ç½²æ–‡æ¡£**: [DEPLOY.md](DEPLOY.md)

## â“ å¸¸è§é—®é¢˜

### Q: æ‰“åŒ…åæ–‡ä»¶å¤ªå¤§ï¼Ÿ

**A:** æ‰“åŒ…è„šæœ¬å·²ç»è‡ªåŠ¨æ’é™¤äº† `node_modules`ã€`target`ã€`.git` ç­‰å¤§æ–‡ä»¶ç›®å½•ã€‚

### Q: æœåŠ¡å™¨æ²¡æœ‰ unzip å‘½ä»¤ï¼Ÿ

**A:** ä½¿ç”¨ tar è§£å‹ï¼š

```bash
# å…ˆè½¬æ¢ä¸º tar.gzï¼ˆåœ¨ Windows ä¸Šï¼‰
# æˆ–ä½¿ç”¨ 7-Zip è§£å‹åé‡æ–°æ‰“åŒ…ä¸º tar.gz

# åœ¨æœåŠ¡å™¨ä¸Š
tar -xzf invoice-deploy.tar.gz -C /tmp/
```

### Q: Maven æ„å»ºéœ€è¦ç½‘ç»œï¼Ÿ

**A:** å¦‚æœå®Œå…¨ç¦»çº¿ï¼Œæœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š

1. **åœ¨æœ‰ç½‘ç»œçš„æœºå™¨ä¸Šæ„å»º**ï¼Œç„¶ååªä¸Šä¼  `target/invoice-service-1.0.0.jar`
2. **ä½¿ç”¨ Maven ç¦»çº¿æ¨¡å¼**ï¼ˆéœ€è¦é¢„å…ˆä¸‹è½½æ‰€æœ‰ä¾èµ–åˆ°æœ¬åœ°ä»“åº“ï¼‰

### Q: å¦‚ä½•æ›´æ–°åº”ç”¨ï¼Ÿ

**A:** é‡æ–°æ‰“åŒ…å¹¶ä¼ è¾“ï¼Œç„¶ååœ¨æœåŠ¡å™¨ä¸Šï¼š

```bash
# åœæ­¢æ—§æœåŠ¡
sudo systemctl stop invoice-service  # å¦‚æœä½¿ç”¨ systemd
# æˆ–
kill $(cat /opt/invoice-service/bin/app.pid)

# æ›¿æ¢ JAR æ–‡ä»¶
sudo cp /tmp/invoice-service-1.0.0.jar /opt/invoice-service/bin/

# é‡å¯æœåŠ¡
sudo systemctl start invoice-service
```

